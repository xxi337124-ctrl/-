# 🎯 立即开始部署 - 操作手册

## 当前状态
✅ 所有代码已准备完毕
⏳ 需要推送到 GitHub
⏳ 然后在 Vercel 部署

---

## 📝 第一步：推送代码到 GitHub

### 方法 A：使用 GitHub Desktop（最简单，强烈推荐）✨

1. **打开 GitHub Desktop**
   - 在 Windows 开始菜单搜索 "GitHub Desktop"
   - 或双击桌面图标

2. **找到项目**
   - 左侧找到仓库 "内容工厂" 或 "-"
   - 如果没有显示，点击左上角 "Current Repository" → "Add" → "Add Existing Repository"
   - 选择文件夹：`D:\新建文件夹\claude code_内容工厂\content-factory`

3. **推送代码**
   - 你会看到 "4 commits ahead" 字样
   - 点击右上角蓝色的 **"Push origin"** 按钮
   - 等待进度条完成

4. **验证成功**
   - 打开浏览器访问：https://github.com/xxi337124-ctrl/-/commits/master
   - 应该能看到 4 个最新的提交记录

---

### 方法 B：使用命令行脚本（需要稳定网络）

1. **双击运行**
   ```
   D:\新建文件夹\claude code_内容工厂\content-factory\推送到GitHub.bat
   ```

2. **如果推送失败**
   - 可能是网络问题
   - 请使用方法 A（GitHub Desktop）

---

### 方法 C：手动推送（高级用户）

```bash
# 进入项目目录
cd "D:\新建文件夹\claude code_内容工厂\content-factory"

# 推送
git push origin master
```

---

## 🔑 第二步：准备 API Keys

在开始 Vercel 部署之前，先获取并保存这些密钥：

### 必需的 API Keys（3个）

#### 1. OpenRouter API Key
- **用途**：Gemini 2.5 Pro（文案生成和分析）
- **获取步骤**：
  1. 访问：https://openrouter.ai/
  2. 点击右上角 "Sign in"
  3. 用 GitHub 或 Google 账号登录
  4. 进入 "Keys" 页面：https://openrouter.ai/keys
  5. 点击 "Create Key"
  6. 复制生成的密钥（格式：`sk-or-v1-xxx...`）

#### 2. SiliconFlow API Key
- **用途**：文生图（智能配图）
- **获取步骤**：
  1. 访问：https://cloud.siliconflow.cn
  2. 注册/登录账号
  3. 进入控制台
  4. 左侧菜单 → "API Key 管理"
  5. 点击 "创建新的 API Key"
  6. 复制生成的密钥（格式：`sk-xxx...`）

#### 3. Doubao API Key
- **用途**：SeeDream 4.0（图生图）
- **获取步骤**：
  1. 访问：https://console.volcengine.com/ark
  2. 注册/登录账号（可能需要实名认证）
  3. 进入 API 管理
  4. 创建 API Key
  5. 复制生成的密钥

### 可选的 API Keys

#### 小红书 Cookie（可选，用于搜索功能）
- **获取步骤**：
  1. 浏览器打开：https://www.xiaohongshu.com
  2. 登录你的账号
  3. 按 F12 打开开发者工具
  4. 点击 "Application" 或"应用程序" 标签
  5. 左侧 "Cookies" → 点击 `https://www.xiaohongshu.com`
  6. 找到 `web_session` 这一行，复制其值
  7. 找到 `xsecappid`，复制其值
  8. 组合格式：`web_session=你的值; xsecappid=xhs-pc-web`

### 💾 保存密钥

**在记事本中整理好，格式如下**：

```
OpenRouter: sk-or-v1-xxxxxxxxxxxxxxxxxxxxx
SiliconFlow: sk-xxxxxxxxxxxxxxxxxxxxx
Doubao: xxxxxxxxxxxxxxxxxxxxx
小红书Cookie: web_session=xxxxx; xsecappid=xhs-pc-web
```

**保存这个文件**，部署时会用到！

---

## 🌐 第三步：Vercel 部署（详细步骤）

### 3.1 注册 Vercel 账号

1. **访问 Vercel**
   - 打开浏览器：https://vercel.com

2. **登录**
   - 点击右上角 "Sign Up" 或 "Login"
   - 选择 **"Continue with GitHub"**
   - 授权 Vercel 访问你的 GitHub 账号

3. **确认登录成功**
   - 你会看到 Vercel Dashboard（仪表盘）

---

### 3.2 导入项目

1. **创建新项目**
   - 点击右上角 **"Add New..."** 按钮
   - 选择 **"Project"**

2. **选择仓库**
   - 在 "Import Git Repository" 列表中
   - 找到你的仓库 **"-"**（内容工厂项目）
   - 点击右侧的 **"Import"** 按钮

3. **配置项目（重要！）**

   **Framework Preset**：
   - 自动识别为 "Next.js"（无需修改）

   **Root Directory**：
   - 如果显示多个文件夹，选择 `content-factory`
   - 如果只有一个，保持默认

   **Build and Output Settings**：
   - 保持默认，不要修改

4. **⚠️ 先不要点击 Deploy！**
   - 点击页面上方的项目名称，返回项目设置
   - 或者关闭当前页面

---

### 3.3 配置环境变量

1. **进入项目设置**
   - 在 Vercel Dashboard，点击你的项目
   - 点击顶部菜单的 **"Settings"** 标签

2. **添加环境变量**
   - 左侧菜单点击 **"Environment Variables"**
   - 添加以下变量（使用第二步准备的密钥）：

#### 添加变量 1
- **Name**: `OPENROUTER_API_KEY`
- **Value**: `sk-or-v1-你的OpenRouter密钥`
- 点击 "Add"

#### 添加变量 2
- **Name**: `SILICONFLOW_API_KEY`
- **Value**: `sk-你的SiliconFlow密钥`
- 点击 "Add"

#### 添加变量 3
- **Name**: `DOUBAO_API_KEY`
- **Value**: `你的Doubao密钥`
- 点击 "Add"

#### 添加变量 4（可选）
- **Name**: `XHS_COOKIE`
- **Value**: `web_session=xxx; xsecappid=xhs-pc-web`
- 点击 "Add"

3. **确认变量已添加**
   - 你应该能看到至少 3 个环境变量
   - ⚠️ 确保没有多余的空格

---

### 3.4 创建 Vercel Postgres 数据库

1. **进入 Storage 设置**
   - 点击顶部菜单的 **"Storage"** 标签

2. **创建数据库**
   - 点击 **"Create Database"** 按钮
   - 或点击 **"Connect Store"** → **"Create New"**

3. **选择数据库类型**
   - 选择 **"Postgres"**

4. **配置数据库**
   - **Database Name**: `content-factory-db`（可以自定义）
   - **Region**: 选择 **Hong Kong (hkg1)** 或 **Singapore (sin1)**
   - 点击 **"Create"** 按钮

5. **连接数据库到项目**
   - 创建成功后，会提示 "Connect to project"
   - 选择你的项目
   - 点击 **"Connect"** 按钮
   - Vercel 会自动添加数据库环境变量：
     - `DATABASE_URL`
     - `POSTGRES_PRISMA_URL`
     - `POSTGRES_URL_NON_POOLING`

6. **验证数据库连接**
   - 返回 "Settings" → "Environment Variables"
   - 确认看到新增的数据库相关变量

---

### 3.5 配置构建命令

1. **进入构建设置**
   - 点击 "Settings" → "General"
   - 滚动到 **"Build & Development Settings"** 部分

2. **覆盖构建命令**
   - 找到 **"Build Command"** 一行
   - 点击右侧的 **"Override"** 开关

3. **输入自定义构建命令**
   - 在文本框中输入：
     ```
     prisma generate && prisma migrate deploy && next build
     ```
   - ⚠️ 这个命令很重要，确保输入正确

4. **保存设置**
   - 点击 **"Save"** 按钮

---

### 3.6 开始部署

1. **触发部署**
   - 点击顶部菜单的 **"Deployments"** 标签
   - 点击右上角的 **"Redeploy"** 或 **"Create Deployment"** 按钮
   - 确认部署

2. **监控部署进度**
   - 你会看到部署日志实时滚动
   - 关键步骤：
     - ✅ Cloning repository...
     - ✅ Installing dependencies...
     - ✅ Running prisma generate...
     - ✅ Running prisma migrate deploy...
     - ✅ Building...
     - ✅ Uploading...
     - ✅ Ready

3. **等待完成**
   - 部署通常需要 2-5 分钟
   - 如果看到绿色的 **"Ready"** 状态，说明部署成功！

4. **如果部署失败**
   - 点击失败的部署
   - 查看 **"Build Logs"** 或 **"Function Logs"**
   - 检查错误信息
   - 常见问题：
     - 环境变量配置错误
     - 数据库未连接
     - 构建命令错误

---

### 3.7 访问你的网站

1. **获取网址**
   - 部署成功后，Vercel 会显示你的网站地址
   - 格式：`https://你的项目名.vercel.app`
   - 或者：`https://xxx-xxx-xxx.vercel.app`

2. **访问网站**
   - 点击链接打开网站
   - 或复制地址到浏览器

3. **首次访问可能较慢**
   - 数据库初始化需要时间
   - 稍等片刻刷新页面

---

## ✅ 第四步：测试所有功能

访问网站后，逐一测试：

### 基础功能测试
- [ ] 首页（Dashboard）能正常加载
- [ ] 导航菜单能正常切换
- [ ] 没有 500 错误

### 选题洞察测试
- [ ] 打开 "选题洞察" 页面
- [ ] 小红书搜索（输入"AI工具"测试）
- [ ] 搜索结果正常显示
- [ ] 能生成洞察报告

### 智能创作测试
- [ ] 打开 "智能创作中心"
- [ ] 输入创作主题
- [ ] 文案生成正常
- [ ] 图片生成正常（可能需要等待 1-2 分钟）

### 小红书二创测试
- [ ] 打开 "小红书二创"
- [ ] 能提取内容
- [ ] 改写功能正常

### 发布管理测试
- [ ] 打开 "发布管理"
- [ ] 能看到生成的文章
- [ ] 文章状态显示正确

### 历史记录测试
- [ ] 打开 "历史记录"
- [ ] 发布后的文章能正常显示

---

## ❌ 常见问题排查

### 问题 1：部署失败 - "Cannot find module 'prisma'"
**解决**：
- 检查构建命令是否正确
- 应该是：`prisma generate && prisma migrate deploy && next build`

### 问题 2：页面 500 错误
**解决**：
1. 在 Vercel Deployments 页面
2. 点击最新部署 → "Function Logs"
3. 查看具体错误
4. 通常是环境变量配置问题

### 问题 3：数据库连接失败
**解决**：
- 确认 Vercel Postgres 已创建
- 确认已连接到项目
- 检查 Settings → Environment Variables 中有 `DATABASE_URL`

### 问题 4：API 调用失败
**解决**：
- 打开浏览器 F12
- 查看 Console 和 Network 错误
- 检查 API Keys 是否正确配置
- 检查 API 账户是否有额度

### 问题 5：图片生成失败
**解决**：
- 确认 SiliconFlow API Key 正确
- 检查 SiliconFlow 账户余额
- 等待 1-2 分钟后重试（首次调用较慢）

---

## 🎉 部署成功！

当所有测试都通过后，恭喜你！你的内容工厂已经成功上线！

### 下一步

1. **分享给朋友**
   - 将网址 `https://你的项目名.vercel.app` 发给朋友
   - 他们可以直接访问使用

2. **绑定自定义域名**（可选）
   - 在 Vercel 项目设置 → Domains
   - 添加你自己的域名

3. **监控使用情况**
   - 在 Vercel Dashboard 查看访问统计
   - 在 Settings → Usage 查看资源使用

4. **后续更新**
   - 修改代码后，只需 Git push
   - Vercel 会自动重新部署

---

## 💰 成本提醒

- **Vercel**: 免费
- **Vercel Postgres**: $0.29/月 起（约 ¥2/月）
- **总计**: 约 ¥2-5/月

小团队使用完全够用！

---

## 📞 需要帮助？

1. 查看部署日志（Vercel Deployments）
2. 查看浏览器控制台错误（F12）
3. 检查环境变量配置
4. 参考本文档的常见问题部分

---

**祝你部署顺利！** 🚀

现在就开始第一步：推送代码到 GitHub！
