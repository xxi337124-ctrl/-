# 🔑 环境变量配置说明

## 📋 已清理的配置

已移除的冗余配置：
- ❌ OPENAI_API_KEY（冗余，改用 OPENROUTER_API_KEY）
- ❌ OPENAI_API_BASE（冗余）
- ❌ OPENAI_MODEL（冗余）
- ❌ GEMINI_API_KEY（冗余，统一用 OPENROUTER）
- ❌ GEMINI_API_BASE（冗余）
- ❌ GEMINI_MODEL（冗余）
- ❌ GEMINI_IMAGE_API_KEY（冗余）
- ❌ GEMINI_IMAGE_API_BASE（冗余）
- ❌ GEMINI_IMAGE_MODEL（冗余）
- ❌ WECHAT_API_KEY（重复，保留 DAJIALA_API_KEY）
- ❌ WECHAT_API_BASE（不需要）
- ❌ UNSPLASH_ACCESS_KEY（未使用）
- ❌ PUBLISH_XHS_API_KEY（未实现）
- ❌ PUBLISH_WECHAT_API_KEY（未实现）
- ❌ SILICONFLOW_API_BASE（已硬编码在代码中）
- ❌ SILICONFLOW_MODEL（已硬编码在代码中）
- ❌ APICORE_API_KEY（未使用）

---

## ✅ 当前必需的配置（3个）

### 1. OPENROUTER_API_KEY
- **用途**：调用 Gemini 2.5 Pro 进行文案生成、内容分析、图片提示词生成
- **获取地址**：https://openrouter.ai/keys
- **格式**：`sk-or-v1-xxxxxxxxxxxxx`
- **你的密钥**：`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`

### 2. SILICONFLOW_API_KEY
- **用途**：文生图（智能创作中心的图片生成）
- **获取地址**：https://cloud.siliconflow.cn/account/ak
- **格式**：`sk-xxxxxxxxxxxxx`
- **你的密钥**：`sk-ifstfbcrpsitvmjthtgrhdpujbvbifvwspcrawphzwqcfznf`

### 3. DOUBAO_API_KEY
- **用途**：SeeDream 4.0 图生图（小红书二创的图片优化）
- **获取地址**：https://console.volcengine.com/ark
- **格式**：`xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx`
- **你的密钥**：`b6a90ade-18fb-46ac-ad2e-4f7c1daf7474`

---

## ⚠️ 可选的配置

### DAJIALA_API_KEY
- **用途**：公众号文章搜索
- **你的密钥**：`JZL825c4023bd4c5960`

### XHS_COOKIE
- **用途**：小红书文章搜索
- **获取方式**：
  1. 浏览器登录 https://www.xiaohongshu.com
  2. 按 F12 打开开发者工具
  3. Application → Cookies → xiaohongshu.com
  4. 复制 `web_session` 的值
- **格式**：`web_session=你的值; xsecappid=xhs-pc-web`
- **当前状态**：未配置（注释掉）

---

## 📝 配置文件位置

### .env（本地开发，不提交到 Git）
```
D:\新建文件夹\claude code_内容工厂\content-factory\.env
```

### .env.example（模板，提交到 Git）
```
D:\新建文件夹\claude code_内容工厂\content-factory\.env.example
```

---

## 🎯 部署到 Vercel 时需要配置的环境变量

在 Vercel 项目设置 → Environment Variables 中添加：

### 必需变量（3个）
```
OPENROUTER_API_KEY = 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
SILICONFLOW_API_KEY = sk-ifstfbcrpsitvmjthtgrhdpujbvbifvwspcrawphzwqcfznf
DOUBAO_API_KEY = b6a90ade-18fb-46ac-ad2e-4f7c1daf7474
```

### 可选变量
```
DAJIALA_API_KEY = JZL825c4023bd4c5960
XHS_COOKIE = web_session=你的值; xsecappid=xhs-pc-web
```

### 数据库变量（Vercel Postgres 自动添加）
```
DATABASE_URL = (自动添加)
POSTGRES_PRISMA_URL = (自动添加)
POSTGRES_URL_NON_POOLING = (自动添加)
```

---

## 🔍 配置验证

### 检查配置是否正确

1. **访问诊断页面**：
   ```
   http://localhost:3000/api/debug/config
   ```

2. **查看配置状态**：
   - ✅ OPENROUTER_API_KEY: 已配置
   - ✅ SILICONFLOW_API_KEY: 已配置
   - ✅ DOUBAO_API_KEY: 已配置
   - ⚠️ XHS_COOKIE: 未配置（可选）

---

## 💡 配置简化说明

### 之前（冗余）
- 有 13 个环境变量
- 多个重复的 API Key
- 未使用的配置

### 现在（精简）
- 只有 5 个环境变量
- 必需：3 个
- 可选：2 个
- 清晰明了，易于维护

---

## 📊 API 使用统计

| API | 用途 | 调用次数 |
|-----|------|---------|
| OpenRouter | 文案生成、分析 | 高频 |
| SiliconFlow | 图片生成 | 中频 |
| Doubao | 图片优化 | 低频 |
| 大家啦 | 公众号搜索 | 按需 |
| 小红书 | 小红书搜索 | 按需 |

---

## 🛡️ 安全提醒

⚠️ **不要将 .env 文件提交到 Git！**

.env 文件已在 .gitignore 中忽略，确保你的 API 密钥安全。

---

## ✅ 完成

环境变量配置已优化完成！

- ✅ 移除 10+ 个冗余配置
- ✅ 保留 3 个必需配置
- ✅ 保留 2 个可选配置
- ✅ 更新 .env.example 模板
- ✅ 添加详细注释

现在配置更清晰、更易维护了！
